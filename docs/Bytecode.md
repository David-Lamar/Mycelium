# Bytecode

| Name         | Byte | Arguments                 | Description                                                                                                                                                                                                                                                                                           |
| ------------ | ---- | ------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
|              |      |                           |                                                                                                                                                                                                                                                                                                       |
| ADD          | 0x00 |                           | Pops the top two values off the stack, adds them together, and pushes the result onto the stack.<br><br>Order of arguments does not matter.                                                                                                                                                           |
| SUB          | 0x08 |                           | Pops the top two values off of the stack, subtracts the second value from the first and pushes the result onto the stack.                                                                                                                                                                             |
| DIV          | 0x10 |                           |                                                                                                                                                                                                                                                                                                       |
| MOD          | 0x18 |                           |                                                                                                                                                                                                                                                                                                       |
| MULT         | 0x20 |                           |                                                                                                                                                                                                                                                                                                       |
|              |      |                           |                                                                                                                                                                                                                                                                                                       |
| AND          | 0x30 |                           |                                                                                                                                                                                                                                                                                                       |
| OR           | 0x38 |                           |                                                                                                                                                                                                                                                                                                       |
| NOT          | 0x40 |                           |                                                                                                                                                                                                                                                                                                       |
|              |      |                           |                                                                                                                                                                                                                                                                                                       |
| CMP          | 0x50 |                           | Pops 2 values off of the stack and compares them. Will push a value onto the stack based on the result of the comparison.<br><br>-1 -> When the second value is less than the first<br> 0 -> When the second value and first art equal<br> 1 -> When the second value is greater than the first       |
| EQ           | x51  |                           | Pops 2 values off the stack and compares them. Will push TRUE onto the stack if they are equal and FALSE otherwise.                                                                                                                                                                                   |
| LT           | x52  |                           | Pops 2 values off the stack and compares them. Will push TRUEE onto the stack if the second value is _less_ than the first and false otherwise                                                                                                                                                        |
| GT           | x53  |                           | Pops 2 values off the stack and compares them. Will push TRUEE onto the stack if the second value is _greater_ than the first and false otherwise                                                                                                                                                     |
|              |      |                           |                                                                                                                                                                                                                                                                                                       |
| JUMP         | 0x60 | \[0\] OFFSET              | Jumps the program counter of the current stack frame by the OFFSET (can be negative)                                                                                                                                                                                                                  |
| JUMP_FALSE   | 0x61 | \[0\] OFFSET              | Jumps the program counter of the current stack frame by the OFFSET (can be negative) if the popped value of the stack is FALSE                                                                                                                                                                        |
| JUMP_SUCCESS | 0x62 | \[0\] OFFSET              | Jumps the program counter of the current stack frame by the OFFSET (can be negative) if the popped value of the stack is NOT an error type.                                                                                                                                                           |
|              |      |                           |                                                                                                                                                                                                                                                                                                       |
| CALL         | 0x70 | \[0-7\] ID<br>            | Will call a function within the function manifest with the corresponding 8 byte hash.<br><br>Arguments to the function will automatically be pulled off the stack -- the number of which and order will be determined by the function manifest.<br>                                                   |
| RETURN       | 0x78 |                           | Will return to the original call site (and include the return values, if present, according to the function manifest for the embodied function).                                                                                                                                                      |
|              |      |                           |                                                                                                                                                                                                                                                                                                       |
|              |      |                           |                                                                                                                                                                                                                                                                                                       |
|              |      |                           |                                                                                                                                                                                                                                                                                                       |
| MAKE_STRUCT  | 0xA0 | \[0-8\] ID                | Will allocate a slot on the stack and use the info from the struct manifest to determine data size, arguments, etc.<br><br>No fields will be populated. STORE_FIELD needs to be used to write data to the struct.                                                                                     |
| MAKE_ARRAY   | 0xA1 |                           | Will allocate a slot on the stack that holds an array type.<br><br>TODO: How to handle types?                                                                                                                                                                                                         |
|              |      |                           |                                                                                                                                                                                                                                                                                                       |
| DUP          | 0xB0 |                           | Duplicates the value on the top of the stack<br><br>**Future State**                                                                                                                                                                                                                                  |
| POP          | 0xB1 |                           | Discard the value on the top of the stack<br><br>**Future State**                                                                                                                                                                                                                                     |
|              |      |                           |                                                                                                                                                                                                                                                                                                       |
| LOAD_LOCAL   | 0xB8 | \[0\] INDEX<br>           | Pushes the value stored in position INDEX onto the stack.<br><br>Note: The local table will be shared with functional arguments. Functional arguments will be pre-populated by the CALL function. Care must be taken to ensure that the correct offset is used for local variables within a function. |
| LOAD_FIELD   | 0xB9 | \[0\] INDEX               | Pops a struct off the stack and then extracts the field at the INDEX and pushes that value to the stack.                                                                                                                                                                                              |
| LOAD_CONST   | 0xBA | \[0\] VALUE               | Pushes VALUE onto the stack                                                                                                                                                                                                                                                                           |
|              |      |                           |                                                                                                                                                                                                                                                                                                       |
|              |      |                           |                                                                                                                                                                                                                                                                                                       |
| STORE_LOCAL  | 0xC0 | \[0\] INDEX               | Pops a VALUE off the stack and writes that value to the INDEX of the local table.                                                                                                                                                                                                                     |
| STORE_FIELD  | 0xC1 | \[0\] INDEX               | Pops a struct off the stack and pops a value off the stack and puts the value into the INDEX of the struct.<br><br>The resulting, modified struct is pushed back into the stack.                                                                                                                      |
| STORE_CONST  | 0xC2 | \[0\] INDEX<br>\[1] VALUE | Takes the VALUE constant and writes that value to the INDEX of the local table.                                                                                                                                                                                                                       |
|              |      |                           |                                                                                                                                                                                                                                                                                                       |
| MULTI_OP     | 0xFF |                           | Reserved for future expansion. Denotes that there will be an additional following byte that will hold additional op codes.<br><br>**Future state (maybe)**                                                                                                                                            |
